if(!nexacro.MultiCombo){nexacro.MultiCombo=function(_a,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l){nexacro._CompositeComponent.call(this,_a,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k,_l);};nexacro.MultiCombo.prototype=nexacro._createPrototype(nexacro._CompositeComponent,nexacro.MultiCombo);nexacro.MultiCombo.prototype._type_name="MultiCombo";nexacro.MultiCombo.prototype.innerdataset="";nexacro.MultiCombo.prototype.codecolumn="";nexacro.MultiCombo.prototype.datacolumn="";nexacro.MultiCombo.prototype.value="";nexacro.MultiCombo.prototype.viewtype="A";nexacro.MultiCombo.prototype.cssclass="";nexacro.MultiCombo.prototype.displaynulltext="전체";nexacro.MultiCombo.prototype.readonly=false;nexacro.MultiCombo.prototype.set_innerdataset=function(_a){if(typeof _a!="string"){this.setInnerDataset(_a);return;}if(this.innerdataset!=_a){if(!_a){this._innerdataset=null;this.innerdataset="";this.form._multicombodataset.clear();}else{_a=_a.replace("@","");this._innerdataset=this._findDataset(_a);this.innerdataset=_a;}this.on_apply_innerdataset(this._innerdataset);}else if(this.innerdataset&&!this._innerdataset){this._setInnerDatasetStr(this.innerdataset);this.on_apply_innerdataset(this._innerdataset);}};nexacro.MultiCombo.prototype.setInnerDataset=function(_a){if(!_a){this._innerdataset=null;this.innerdataset="";this.on_apply_innerdataset(null);this.form._multicombodataset.clear();}else if(_a instanceof nexacro.Dataset||(typeof _a=="object"&&_a._type_name=="Dataset")){this._innerdataset=_a;this.innerdataset=_a.id;this.on_apply_innerdataset(_a);}};nexacro.MultiCombo.prototype._setInnerDatasetStr=function(_a){if(_a){_a=_a.replace("@","");this._innerdataset=this._findDataset(_a);this.innerdataset=_a;}else{this._innerdataset=null;this.innerdataset="";this.form._multicombodataset.clear();}};nexacro.MultiCombo.prototype.on_apply_innerdataset=function(_a){this.copyDataset(_a);};nexacro.MultiCombo.prototype.copyDataset=function(_a){if(this.form.edtCombo){this.form._multicombodataset.copyData(_a);if(this._isNull(this.form._multicombodataset.getColumnInfo("_chk"))){this.form._multicombodataset.addColumn("_chk","STRING");}if(this.viewtype=="A"){this.form.pdvList.form.grdList.setCellProperty("body",1,"text","bind:"+this.codecolumn);this.form.pdvList.form.grdList.setCellProperty("body",2,"text","bind:"+this.datacolumn);}else{this.form.pdvList.form.grdList.setCellProperty("body",1,"text","bind:"+this.datacolumn);}}};nexacro.MultiCombo.prototype.set_codecolumn=function(_a){this.codecolumn=_a;};nexacro.MultiCombo.prototype.set_datacolumn=function(_a){this.datacolumn=_a;};nexacro.MultiCombo.prototype.set_value=function(_a){this.value=_a;if(this.form.edtCombo){try{this.form.fnComboChkClear();this.form.fnDataToList();this.form.fnListToData();}catch(ex){}}};nexacro.MultiCombo.prototype.set_viewtype=function(_a){this.viewtype=_a;if(this.form.edtCombo){if(_a=="A"){this.form.pdvList.form.grdList.set_formatid("");this.form.pdvList.form.grdList.setCellProperty("body",1,"text","bind:"+this.codecolumn);this.form.pdvList.form.grdList.setCellProperty("body",2,"text","bind:"+this.datacolumn);}else{this.form.pdvList.form.grdList.set_formatid("B");this.form.pdvList.form.grdList.setCellProperty("body",1,"text","bind:"+this.datacolumn);}}};nexacro.MultiCombo.prototype.set_displaynulltext=function(_a){this.displaynulltext=_a;if(this.form.edtCombo){try{this.form.fnDataToList();this.form.fnListToData();}catch(ex){}}};nexacro.MultiCombo.prototype._isNull=function(_a){if(new String(_a).valueOf()=="undefined"){return true;}if(_a==null){return true;}var _b=new String(_a);if(_b==null){return true;}if(_b.toString().length==0){return true;}return false;};nexacro.MultiCombo.prototype.set_readonly=function(_a){if(typeof (_a)!="boolean"){_a=(_a=="true")?true:false;}if(this.form.btnDrop){this.form.btnDrop.set_visible(!_a);}};nexacro.MultiCombo.prototype.set_cssclass=function(_a){this.cssclass=_a;if(this.form.edtCombo){this.form.edtCombo.set_cssclass(_a);}};nexacro.MultiCombo.prototype.on_getBindableProperties=function(){return ["value"];};nexacro.MultiCombo.prototype.on_init_bindSource=function(_a,_b,_c){if(_b=="value"){this.value=undefined;}};nexacro.MultiCombo.prototype.on_change_bindSource=function(_a,_b,_c,_d){if(_a=="value"){this.set_value(_b.getColumn(_c,_d));}};}nexacro.MultiCombo.prototype._get_form_module=function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("MultiCombo");this.set_titletext("MultiCombo");if(nexacro.Form==this.constructor){this._setFormPosition(170,24);}_a=new nexacro.NormalDataset("_multicombodataset",this);_a._setContents("<ColumnInfo><Column id=\"_chk\" type=\"STRING\" size=\"256\"/><Column id=\"code\" type=\"STRING\" size=\"256\"/><Column id=\"data\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new nexacro.PopupDiv("pdvList","0","24","224","185",null,null,null,null,null,null,this);_a.set_visible("false");_a.set_background("#ffffff");this.addChild(_a.name,_a);_a=new nexacro.Grid("grdList","0","0",null,null,"0","0",null,null,null,null,this.pdvList.form);_a.set_taborder("1");_a.set_binddataset("_multicombodataset");_a.set_autofittype("col");_a.set_cssclass("grid_WF_list");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"30\"/><Column size=\"80\"/><Column size=\"214\"/></Columns><Rows><Row size=\"28\" band=\"head\"/><Row size=\"28\"/></Rows><Band id=\"head\"><Cell edittype=\"checkbox\" displaytype=\"checkboxcontrol\" text=\"0\"/><Cell col=\"1\" text=\"코드\"/><Cell col=\"2\" text=\"코드명\"/></Band><Band id=\"body\"><Cell text=\"bind:_chk\" edittype=\"checkbox\" displaytype=\"checkboxcontrol\"/><Cell col=\"1\" text=\"bind:code\" textAlign=\"center\"/><Cell col=\"2\" text=\"bind:data\" textAlign=\"left\"/></Band></Format><Format id=\"B\"><Columns><Column size=\"30\"/><Column size=\"214\"/></Columns><Rows><Row size=\"30\" band=\"head\"/><Row size=\"30\"/></Rows><Band id=\"head\"><Cell edittype=\"checkbox\" displaytype=\"checkboxcontrol\" text=\"0\"/><Cell col=\"1\" text=\"코드명\"/></Band><Band id=\"body\"><Cell text=\"bind:_chk\" edittype=\"checkbox\" displaytype=\"checkboxcontrol\"/><Cell col=\"1\" text=\"bind:data\" textAlign=\"left\"/></Band></Format></Formats>");this.pdvList.addChild(_a.name,_a);_a=new nexacro.Edit("edtCombo","0","0",null,"24","0",null,null,null,null,null,this);_a.set_taborder("0");this.addChild(_a.name,_a);_a=new nexacro.Button("btnDrop",null,"0","24","24","0",null,null,null,null,null,this);_a.set_taborder("1");_a.set_cssclass("btn_WF_drop");_a.set_text("");this.addChild(_a.name,_a);_a=new nexacro.Layout("default","",170,24,this,function(_b){});this.addLayout(_a.name,_a);};this.loadPreloadList=function(){};this.registerScript("MultiCombo.xcdl",function(){this._onload=function(_a,_b){if(!this.parent._isNull(this.parent._innerdataset)){this.parent.copyDataset(this.parent._innerdataset);}if(!this.parent._isNull(this.parent.cssclass)){this.parent.set_cssclass(this.parent.cssclass);}if(!this.parent._isNull(this.parent.viewtype)){this.parent.set_viewtype(this.parent.viewtype);}if(this.parent._isNull(this.parent.value)){this.edtCombo.set_value(this.parent.displaynulltext);}else{this.parent.set_value(this.parent.value);}};this.btnDrop_onclick=function(_a,_b){if(this._multicombodataset.rowcount<1){return;}this.fnComboChkClear();this.fnDataToList();this.pdvList.trackPopupByComponent(this.edtCombo,this.edtCombo.left,this.edtCombo.height);};this.fnComboChkClear=function(){for(var _b=0;_b<this._multicombodataset.rowcount;_b++ ){this._multicombodataset.setColumn(_b,"_chk","0");}};this.fnDataToList=function(){if(!this.parent._isNull(this.parent.value)){var _b=this.parent.value.split(",");var _c;for(var _d=0;_d<this._multicombodataset.rowcount;_d++ ){_c=this._multicombodataset.getColumn(_d,this.parent.codecolumn);if(_b.indexOf(_c)> -1){this._multicombodataset.setColumn(_d,"_chk","1");}}}else{if(this.parent.displaynulltext=="전체"){for(var _d=0;_d<this._multicombodataset.rowcount;_d++ ){this._multicombodataset.setColumn(_d,"_chk","1");}}else{for(var _d=0;_d<this._multicombodataset.rowcount;_d++ ){this._multicombodataset.setColumn(_d,"_chk","0");}}}if(this._multicombodataset.getCaseCount("_chk == '1'")==this._multicombodataset.rowcount){this.pdvList.form.grdList.setCellProperty("head",0,"text","1");}else{this.pdvList.form.grdList.setCellProperty("head",0,"text","0");}};this.fnListToData=function(){var _b="";var _c="";var _d=0;for(var _e=0;_e<this._multicombodataset.rowcount;_e++ ){if(this._multicombodataset.getColumn(_e,"_chk")=="1"){_b+=(this.parent._isNull(_b))?this._multicombodataset.getColumn(_e,this.parent.codecolumn):","+this._multicombodataset.getColumn(_e,this.parent.codecolumn);if(this.parent._isNull(_c)){_c=this._multicombodataset.getColumn(_e,this.parent.datacolumn);}else{_d++ ;}};}if(_d>0){_c+="외 "+_d+"건";}if(this.parent.displaynulltext=="전체"){if(_d==0||(this._multicombodataset.getCaseCount("_chk == '1'")==this._multicombodataset.rowcount)){_c=this.parent.displaynulltext;_b="";}}else{if(this._multicombodataset.getCaseCount("_chk == '1'")==0){_c=this.parent.displaynulltext;}}this.edtCombo.set_value(_c);this.parent.value=_b;this.parent.applyto_bindSource("value",_b);};this.pdvList_oncloseup=function(_a,_b){this.fnListToData();};this.pdvList_grdList_oncellclick=function(_a,_b){if(_b.clickitem=="control"){return;}var _c=this._multicombodataset.getColumn(_b.row,"_chk");if(_c=="1"){this._multicombodataset.setColumn(_b.row,"_chk","0");}else{this._multicombodataset.setColumn(_b.row,"_chk","1");}};this._multicombodataset_oncolumnchanged=function(_a,_b){if(_b.columnid=="_chk"){if(_a.getCaseCount("_chk == '1'")==_a.rowcount){this.pdvList.form.grdList.setCellProperty("head",0,"text","1");}else{this.pdvList.form.grdList.setCellProperty("head",0,"text","0");}}};this.pdvList_grdList_onheadclick=function(_a,_b){if(_a.readonly==true){return;}var _c;var _d;var _e;var _f;var _g;var _h=_b.cell;var _i;var _j=_a.getSubCellCount("head",_h);_g=_a.getBindDataset();if(_g.getRowCount()<1){return;}if(_a.getCellCount("body")!=_a.getCellCount("head")){_i=parseInt(_a.getCellProperty("head",_h,"col"));}else{_i=_b.cell;}_f=_a.getCellProperty("body",_i,"text");_f=_f.toString().replace("bind:","");_c=_a.getCellProperty("head",_h,"displaytype");if(_c!="checkboxcontrol"){return;}_e=_a.getCellProperty("head",_h,"text");if(_e=="1"){_a.setCellProperty("head",_h,"text","0");var _k=this._gfnGridGetBodyCellIndex(_a,_h);var _l=this._gfnGridGetBindColumnNameByIndex(_a,_k);if(_l=="gridcmmcheck"){_d="";}else{_d="0";}}else{_a.setCellProperty("head",_h,"text","1");_d="1";}_g.set_enableevent(false);for(var _m=0;_m<_g.rowcount;_m++ ){_g.setColumn(_m,_f,_d);}_g.set_enableevent(true);};this.edtCombo_oninput=function(_a,_b){_a.set_value(_a._default_value);};});this.on_initEvent=function(){this.addEventHandler("onload",this._onload,this);this.pdvList.addEventHandler("oncloseup",this.pdvList_oncloseup,this);this.pdvList.form.grdList.addEventHandler("oncellclick",this.pdvList_grdList_oncellclick,this);this.pdvList.form.grdList.addEventHandler("onheadclick",this.pdvList_grdList_onheadclick,this);this.edtCombo.addEventHandler("oninput",this.edtCombo_oninput,this);this.btnDrop.addEventHandler("onclick",this.btnDrop_onclick,this);this._multicombodataset.addEventHandler("oncolumnchanged",this._multicombodataset_oncolumnchanged,this);};this.loadIncludeScript("MultiCombo.xcdl");this.loadPreloadList();_a=null;};};
